{
  "hash": "f79f72385aa3ca1df7235ce3fa4f852e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home_Ex01\"\nauthor: \"Stefanie Felicia\"\ndate: \"\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n\n# 1. Background\n\nbackground of what I'm doing and objective of the analysis\n\nA local online media company that publishes daily content on digital platforms is planning to release an article on **demographic structures and distribution of Singapore in 2024**.\n\n## 1.2 The Data\n\nThe dataset was extracted from <a href = https://www.singstat.gov.sg/find-data/search-by-theme/population/geographic-distribution/latest-data>Singstat</a> under the name <b>Singapore Residents by Planning Area / Subzone, Single Year of Age and Sex, June 2024</b>.\n\n![](images/screenshot_dataset.png)\n\nIt comprised of 6 variables and 60K records. The dataset recorded the demographics and count of residents who lived in each sub zone and planning area in June 2024.\n\n## 1.3 Load Required Libraries\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(dplyr, tidyverse, scales, forcats, DT)\n```\n:::\n\n\n\n## 1.4 Import Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npopulation_data <- read_csv(\"respopagesex2024.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 60424 Columns: 6\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): PA, SZ, Age, Sex\ndbl (2): Pop, Time\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n\nAs can be seen above, the data set comprise of 6 variables: 4 variables are character data type (namely, PA, SZ, age and sex), and 2 variables are double data type (number of population, time). Here is the a snippet of the data set:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(population_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 6\n  PA         SZ                     Age   Sex       Pop  Time\n  <chr>      <chr>                  <chr> <chr>   <dbl> <dbl>\n1 Ang Mo Kio Ang Mo Kio Town Centre 0     Males      10  2024\n2 Ang Mo Kio Ang Mo Kio Town Centre 0     Females    10  2024\n3 Ang Mo Kio Ang Mo Kio Town Centre 1     Males      10  2024\n4 Ang Mo Kio Ang Mo Kio Town Centre 1     Females    10  2024\n5 Ang Mo Kio Ang Mo Kio Town Centre 2     Males      10  2024\n6 Ang Mo Kio Ang Mo Kio Town Centre 2     Females    10  2024\n```\n\n\n:::\n:::\n\n\n\n# 2. Data pre-processing\n\nFirst, we will look if there are duplicates found in the data set.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(population_data[duplicated(population_data), ])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n\n\nNext, we will check for missing values in the data set.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsapply(population_data, function(x) sum(is.na(x)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  PA   SZ  Age  Sex  Pop Time \n   0    0    0    0    0    0 \n```\n\n\n:::\n:::\n\n\n\n## 2.1 Column Transformation\n\n::: panel-tabset\n## Age\n\nCurrently, the Age variable is in string data type and we want to change it to numeric data type.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npopulation_data$Age[population_data$Age == \"90_and_Over\"] <- \"90\"\ntypeof(population_data$Age) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"character\"\n```\n\n\n:::\n\n```{.r .cell-code}\npopulation_data$Age <- as.numeric(population_data$Age)\n```\n:::\n\n\n\n## Sex\n\nWe also want to recode the Sex variable from \"Males\" to 0 and \"Females\" to 1, why ?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npopulation_data$Sex[population_data$Sex == \"Females\"] <- \"1\"\npopulation_data$Sex[population_data$Sex == \"Males\"] <- \"0\"\npopulation_data$Sex <- as.numeric(population_data$Sex)\n```\n:::\n\n\n:::\n\nUnivariate\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(population_data, aes(x = factor(Sex))) +\n  geom_bar(color = \"grey30\", fill = \"steelblue\") +\n  scale_x_discrete(labels = c(\"0\" = \"Male\", \"1\" = \"Female\")) +\n  labs(x = \"Gender\", y = \"Count\", title = \"Count of Records by Gender\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=population_data, \n       aes(x = Age)) +\n  geom_histogram(bins=20, color=\"gray30\", fill=\"steelblue\")+ \n  labs(title = \"Age Distribution of Singapore Resident\",\n       x = \"Age\",\n       y = \"Count\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n# Variable Selection\n\nThe following variables are used to create visualizations:\n\n-   Population count (Pop):\n\n-   Age:\n\n-   Gender (Sex):\n\n-   Planning Area (PA):\n\n-   Subzone (SZ)\n\n# 3. Visualization\n\n## 3.1 Age and Gender Distribution of Singapore Residents\n\n::: panel-tabset\n## Graph\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-10-1.png){width=768}\n:::\n:::\n\n\n\n## Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npopulation_data <- population_data %>%\n  mutate(age_group = cut(Age, \n               breaks = c(seq(0, 90, 5), Inf),  \n               right = FALSE, \n               include.lowest = TRUE,\n               labels = c(paste(seq(0, 85, 5), seq(4, 89, 5), sep = \"-\"), \"90+\")),\n             Sex = factor(Sex, levels = c(0, 1), labels = c(\"Male\", \"Female\")),\n    PopAdj = ifelse(Sex == \"Male\", -Pop, Pop)\n  )\nagg_data <- population_data %>%\n  group_by(age_group, Sex) %>%\n  summarise(Pop = sum(PopAdj), .groups = 'drop')\nggplot(agg_data, aes(x = age_group, y = Pop, fill = Sex)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(title = \"Age-Sex Pyramid\", x = \"Age Group\", y = \"Population\") +\n  scale_y_continuous(labels = abs)\n```\n:::\n\n\n:::\n\nInsight from the visualization:\n\n-   Singapore has a higher economically active population (aged 15 – 65) than elderly (aged 65+) and young dependents (aged 0 – 14) in 2024. Thus, we can conclude that Singapore’s population has a stationary pyramid\n\n-   Singapore also has roughly similar proportion of male to female population as well as similar age distribution between male and female.\n\n-   The population also has a high number of elderly, which can indicate an advanced healthcare system and low mortality rate.\n\n## 3. 2 Population and Demographics of Residents Living in Each Planning Area\n\n::: panel-tabset\n## Graph\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-12-1.png){width=768}\n:::\n:::\n\n\n\n## Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop_pa <- population_data %>%\n  group_by(PA) %>%\n  summarise(total_pop = sum(Pop))\npop_pa$PA <- fct_rev(factor(pop_pa$PA, levels = pop_pa$PA[order(pop_pa$total_pop, decreasing = TRUE)]))\nggplot(data = pop_pa, aes(x = PA, y = total_pop)) +\n  geom_col(color = \"gray30\", fill = \"steelblue\") +\n  labs(\n    title = \"Singapore Resident Population by Planning Area\",\n    x = \"Planning Area\",\n    y = \"Count\"\n  ) +\n  scale_y_continuous(labels = label_comma())+ theme_minimal() +\n  coord_flip()\n```\n:::\n\n\n:::\n\nDemographics of Residents Living in Each Planning Area\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 55 × 20\n   PA        `0-4` `5-9` `10-14` `15-19` `20-24` `25-29` `30-34` `35-39` `40-44`\n   <chr>     <dbl> <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n 1 Ang Mo K…  4470  5950    6500    7420    7900    9310   10340    9730   10750\n 2 Bedok      9010 11490   12230   13370   14540   16510   18450   18310   19020\n 3 Bishan     2990  3800    4120    4450    4610    5640    6630    5910    5660\n 4 Boon Lay      0     0       0       0       0       0       0       0       0\n 5 Bukit Ba…  8070  8250    7680    8340    9340   10690   13710   13670   11430\n 6 Bukit Me…  5110  5730    6290    6410    6360    8020    9940   10590   10970\n 7 Bukit Pa…  5450  6350    6950    7510    8230    9730   10680   10190    9720\n 8 Bukit Ti…  3430  5720    5310    5100    4460    4340    4720    5730    6390\n 9 Central …     0     0       0       0       0       0       0       0       0\n10 Changi      130   150     120     100      80      90     130     180     150\n# ℹ 45 more rows\n# ℹ 10 more variables: `45-49` <dbl>, `50-54` <dbl>, `55-59` <dbl>,\n#   `60-64` <dbl>, `65-69` <dbl>, `70-74` <dbl>, `75-79` <dbl>, `80-84` <dbl>,\n#   `85-89` <dbl>, `90+` <dbl>\n```\n\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-b64d105b03036d103616\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b64d105b03036d103616\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>Population by Planning Area and Age Group<\\/caption>\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\"],[\"Ang Mo Kio\",\"Bedok\",\"Bishan\",\"Boon Lay\",\"Bukit Batok\",\"Bukit Merah\",\"Bukit Panjang\",\"Bukit Timah\",\"Central Water Catchment\",\"Changi\",\"Changi Bay\",\"Choa Chu Kang\",\"Clementi\",\"Downtown Core\",\"Geylang\",\"Hougang\",\"Jurong East\",\"Jurong West\",\"Kallang\",\"Lim Chu Kang\",\"Mandai\",\"Marina East\",\"Marina South\",\"Marine Parade\",\"Museum\",\"Newton\",\"North-Eastern Islands\",\"Novena\",\"Orchard\",\"Outram\",\"Pasir Ris\",\"Paya Lebar\",\"Pioneer\",\"Punggol\",\"Queenstown\",\"River Valley\",\"Rochor\",\"Seletar\",\"Sembawang\",\"Sengkang\",\"Serangoon\",\"Simpang\",\"Singapore River\",\"Southern Islands\",\"Straits View\",\"Sungei Kadut\",\"Tampines\",\"Tanglin\",\"Tengah\",\"Toa Payoh\",\"Tuas\",\"Western Islands\",\"Western Water Catchment\",\"Woodlands\",\"Yishun\"],[4470,9010,2990,0,8070,5110,5450,3430,0,130,0,7680,4110,90,4670,8080,1980,8850,3350,0,70,0,0,1680,10,480,0,1950,0,410,4900,0,0,12650,3930,470,400,0,6220,13110,3660,0,240,140,0,10,14650,1130,850,6390,0,0,10,10500,10070],[5950,11490,3800,0,8250,5730,6350,5720,0,150,0,9030,5150,90,4680,10020,2540,11590,3990,0,110,0,0,2440,10,630,0,2950,10,440,6370,0,0,15780,4130,700,390,0,6350,16530,4540,0,340,180,0,0,14190,1600,300,6330,0,0,40,11850,11980],[6500,12230,4120,0,7680,6290,6950,5310,0,120,0,9370,5210,70,4470,9960,2990,13400,4040,0,90,0,0,2500,0,620,0,2880,40,700,7100,0,0,14210,4470,660,420,0,6160,16640,5130,0,250,170,0,50,12560,1580,290,5740,0,0,50,12810,11450],[7420,13370,4450,0,8340,6410,7510,5100,0,100,0,10450,5150,90,4800,10600,3540,15080,4080,0,130,0,0,2320,0,550,0,2540,50,650,7910,0,0,11140,4440,660,510,10,6590,15290,5750,0,210,160,0,0,12840,1280,230,5840,0,0,20,14940,11280],[7900,14540,4610,0,9340,6360,8230,4460,0,80,0,12720,4910,110,5080,12010,4320,16270,4470,0,150,0,0,2270,0,380,0,2280,20,510,9830,0,0,8950,4630,560,520,10,6780,14050,6380,0,160,110,0,30,14340,1080,200,6020,0,0,120,18490,12150],[9310,16510,5640,0,10690,8020,9730,4340,0,90,0,16260,5290,270,7020,15270,4890,17860,5500,0,150,0,0,2310,40,440,0,2830,10,870,12360,0,0,9500,5870,530,770,0,7020,15640,7920,0,150,90,0,60,20130,1160,890,7760,0,0,40,22000,15010],[10340,18450,6630,0,13710,9940,10680,4720,0,130,0,15460,7110,560,10770,17470,4960,18230,7230,0,140,0,0,2600,50,590,0,3460,70,1040,10980,0,0,16160,7720,750,910,0,9560,20370,8900,0,260,120,0,40,26990,1430,1700,12270,0,0,30,20010,18710],[9730,18310,5910,0,13670,10590,10190,5730,0,180,0,13160,7810,640,9570,17090,4740,17410,7400,0,150,0,0,3110,100,830,0,3950,60,970,8900,0,0,20880,7520,910,1070,0,9360,23410,8050,0,430,180,0,40,23000,1880,850,11240,0,0,60,17490,18920],[10750,19020,5660,0,11430,10970,9720,6390,0,150,0,12580,8220,540,8350,15980,4860,19430,7420,0,130,0,0,3570,110,890,0,4230,120,1180,9220,0,0,21610,7480,1210,1020,0,8710,24470,7510,0,470,230,0,30,19710,2140,650,9620,0,0,80,16910,17980],[11280,19840,5920,0,11390,11390,9260,6560,0,160,0,12270,8010,460,7980,15120,4990,20000,7590,0,160,0,0,3810,90,910,0,4360,120,1370,9780,0,0,17490,7680,1220,1020,30,8900,21810,7680,0,450,270,0,40,17200,2150,400,9560,0,0,50,17480,15660],[12110,20680,6460,0,12160,11220,10130,6680,0,140,0,14100,7670,390,8020,16300,5580,19960,7720,0,180,0,0,3910,100,870,0,4280,130,1240,10670,0,0,14080,7820,1150,1040,70,8810,19680,8320,0,420,290,0,80,17440,2080,360,9830,0,0,10,19930,15840],[11720,19890,5970,0,12270,10320,10120,5430,0,100,0,15970,6580,300,7780,16540,5530,19250,7080,0,160,0,0,3250,20,690,0,3520,60,1190,13090,0,0,10060,7020,860,880,20,7330,16110,8280,0,260,220,0,30,19170,1650,300,9030,0,0,20,21040,15940],[12440,21330,6710,0,12450,10420,10890,5000,0,100,0,14880,6330,190,8530,18400,5950,18110,7490,0,180,0,0,3140,0,590,0,3190,70,1350,12590,0,0,8540,6660,630,900,0,6500,15180,9080,0,220,200,0,60,21740,1410,290,9520,0,0,50,18490,17570],[12010,20560,6600,0,11400,10390,9390,4570,0,80,0,11210,6020,160,8320,17210,6130,16380,7220,0,130,0,0,2770,0,480,0,2900,40,1330,8980,0,0,6970,6010,580,910,0,5050,13250,9370,0,140,110,0,50,20330,1170,290,9250,0,0,10,14130,14800],[11160,17330,5220,0,8220,9480,6450,3980,0,40,0,7410,6060,110,6650,12640,5290,12550,6290,0,90,0,0,2410,0,360,0,2480,70,1260,5720,0,0,5370,5490,440,860,0,3330,9300,7410,0,100,80,0,40,14550,1040,200,7730,0,0,0,9130,10790],[7970,12220,3450,0,4700,7350,3850,2990,0,30,0,4070,4570,50,4580,7870,3290,7270,4580,0,70,0,0,2020,0,300,0,1840,0,940,3390,0,0,3540,4620,360,600,0,1870,5560,4870,0,80,20,0,20,8230,870,90,5800,0,0,0,5240,6240],[5100,6790,2110,0,2450,4860,2070,1880,0,10,0,2150,2600,0,2820,4470,1670,3670,2920,0,30,0,0,1340,0,140,0,1210,0,590,1940,0,0,1700,3220,160,400,0,1180,2940,2740,0,20,0,0,0,4250,430,20,4130,0,0,0,2770,3350],[2760,3870,1210,0,1380,2830,1160,1240,0,20,0,1210,1410,10,1670,2450,870,1710,1730,0,0,0,0,920,0,90,0,800,0,380,1080,0,0,840,2140,30,200,0,600,1470,1690,0,0,10,0,10,2340,280,20,2520,0,0,0,1550,1700],[1530,2220,750,0,790,1710,600,720,0,20,0,660,750,40,1060,1300,470,890,1090,0,10,0,0,580,0,70,0,500,0,320,670,0,0,410,1190,90,220,0,350,740,970,0,0,0,0,10,1290,180,10,1450,0,0,0,750,880]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>PA<\\/th>\\n      <th>0-4<\\/th>\\n      <th>5-9<\\/th>\\n      <th>10-14<\\/th>\\n      <th>15-19<\\/th>\\n      <th>20-24<\\/th>\\n      <th>25-29<\\/th>\\n      <th>30-34<\\/th>\\n      <th>35-39<\\/th>\\n      <th>40-44<\\/th>\\n      <th>45-49<\\/th>\\n      <th>50-54<\\/th>\\n      <th>55-59<\\/th>\\n      <th>60-64<\\/th>\\n      <th>65-69<\\/th>\\n      <th>70-74<\\/th>\\n      <th>75-79<\\/th>\\n      <th>80-84<\\/th>\\n      <th>85-89<\\/th>\\n      <th>90+<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"PA\",\"targets\":1},{\"name\":\"0-4\",\"targets\":2},{\"name\":\"5-9\",\"targets\":3},{\"name\":\"10-14\",\"targets\":4},{\"name\":\"15-19\",\"targets\":5},{\"name\":\"20-24\",\"targets\":6},{\"name\":\"25-29\",\"targets\":7},{\"name\":\"30-34\",\"targets\":8},{\"name\":\"35-39\",\"targets\":9},{\"name\":\"40-44\",\"targets\":10},{\"name\":\"45-49\",\"targets\":11},{\"name\":\"50-54\",\"targets\":12},{\"name\":\"55-59\",\"targets\":13},{\"name\":\"60-64\",\"targets\":14},{\"name\":\"65-69\",\"targets\":15},{\"name\":\"70-74\",\"targets\":16},{\"name\":\"75-79\",\"targets\":17},{\"name\":\"80-84\",\"targets\":18},{\"name\":\"85-89\",\"targets\":19},{\"name\":\"90+\",\"targets\":20}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nInsight from in demographics and population distribution:\n\n-   Most residents live in Tampines, Bedok, Sengkang, Jurong West, or Woodlands. With each planning area having more than 200,000 residents living in the planning area. This could be\n\n-   There are 13 out of 55 planning areas no residents live in.\n\n-   A lot of younger population (aged 0 – 14) lIve in these planning area: Tampines, Sengkang. Punggol, Woodlands, Yishun or Jurong West\n\n-   The following planning areas have higher number of elderly who lives there: Bedok, Bukit Merah, Ang Mo Kio, Toa Payoh, Hougang\n\n# 4. References\n\n1.  <a href=https://www.statology.org/r-count-duplicates/>How to Count Duplicates in R (With Examples)</a>\n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}